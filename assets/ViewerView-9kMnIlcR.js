import{d as ae,i as V,g as se,c as w,h as m,o as y,j as c,n as D,k as O,p as Y,v as Te,t as E,G as R,M as ie,I as oe,r as B,A as Fe,B as Ie,F as _,l as W,z as P,N as mt,C as Me,O as Pe,P as gt,Q as Ue,J as bt,e as z,b as fe,w as We,u as G,a as Ve,D as wt,S as kt,q as xt}from"./index-D-HoPwQc.js";import{j as Oe,g as St,_ as ue,k as Ct,l as $t,m as Mt,s as _e,e as Ce,n as Lt,o as Ot,p as dt,q as Be,t as qe,v as Et,C as _t,R as At,w as Nt,u as Rt,a as Tt,U as je,X as Dt}from"./_commonjsHelpers-Cxm5dhtY.js";import{u as Ft}from"./settings-Cvl-XAIb.js";import{D as It}from"./download-DYlrNexe.js";import{c as ze}from"./createLucideIcon-Rc0edyhf.js";import{a as zt,F as Ht}from"./folder-open-DnPyZbdy.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=ze("Maximize2Icon",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=ze("Minimize2Icon",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=ze("TableIcon",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);var Ee={exports:{}},Vt=Ee.exports,Ge;function Bt(){return Ge||(Ge=1,(function(e,t){(function(l,o){o()})(Vt,function(){function l(i,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}function o(i,u,f){var h=new XMLHttpRequest;h.open("GET",i),h.responseType="blob",h.onload=function(){d(h.response,u,f)},h.onerror=function(){console.error("could not download file")},h.send()}function r(i){var u=new XMLHttpRequest;u.open("HEAD",i,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function a(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(u)}}var n=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Oe=="object"&&Oe.global===Oe?Oe:void 0,s=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=n.saveAs||(typeof window!="object"||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(i,u,f){var h=n.URL||n.webkitURL,p=document.createElement("a");u=u||i.name||"download",p.download=u,p.rel="noopener",typeof i=="string"?(p.href=i,p.origin===location.origin?a(p):r(p.href)?o(i,u,f):a(p,p.target="_blank")):(p.href=h.createObjectURL(i),setTimeout(function(){h.revokeObjectURL(p.href)},4e4),setTimeout(function(){a(p)},0))}:"msSaveOrOpenBlob"in navigator?function(i,u,f){if(u=u||i.name||"download",typeof i!="string")navigator.msSaveOrOpenBlob(l(i,f),u);else if(r(i))o(i,u,f);else{var h=document.createElement("a");h.href=i,h.target="_blank",setTimeout(function(){a(h)})}}:function(i,u,f,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof i=="string")return o(i,u,f);var p=i.type==="application/octet-stream",v=/constructor/i.test(n.HTMLElement)||n.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||p&&v||s)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var M=x.result;M=g?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=M:location=M,h=null},x.readAsDataURL(i)}else{var $=n.URL||n.webkitURL,C=$.createObjectURL(i);h?h.location=C:location.href=C,h=null,setTimeout(function(){$.revokeObjectURL(C)},4e4)}});n.saveAs=d.saveAs=d,e.exports=d})})(Ee)),Ee.exports}var qt=Bt();const De=St(qt),jt=ae({setup(){const e=V("bundle-index"),t=V("dat-schemas"),l=se(localStorage.getItem("POE_PATCH_VER")||""),o=se();l.value&&!e.isLoaded&&a(),t.isLoaded||t.fetchSchema(),n();async function r(s){const d=s.target.files[0],i=new Uint8Array(await d.arrayBuffer()),u=d.name;ct({id:`file@${u}`,title:u,type:yt,args:{fileContent:i,fullPath:u}})}async function a(){try{await e.loader.setPatch(l.value),await e.loadIndex(),localStorage.setItem("POE_PATCH_VER",l.value)}catch(s){throw window.alert(s.message),s}}async function n(){const d=await(await fetch("https://poe-versions.obsoleet.org")).json();o.value=d}return{index:e,poePatch:l,latestPoEPatch:o,isCdnImportRunning:w(()=>e.loader.progress.value!=null),isFetchingSchema:w(()=>t.isLoading),handleFile:r,cdnImport:a}}}),Gt="_input_16vaf_2",Jt="_label_16vaf_20",Yt="_importVariant_16vaf_26",Kt={input:Gt,label:Jt,importVariant:Yt},Xt={class:"p-4 overflow-auto border-l flex-1 text-base"},Qt={class:"flex gap-x-4 items-baseline mt-4"},Zt={class:"inline-flex items-baseline pb-2"},en={style:{width:"200px"},class:"my-1"},tn={style:{width:"100px"},class:"m-1"},nn={style:{width:"220px"},class:"my-1"},rn=["disabled","loading"],on={key:0},an={class:"px-1 border border-gray-300 rounded"},ln={class:"px-1 border border-gray-300 rounded"},sn={key:0,class:"text-red-600"},un={class:"flex gap-x-4 items-baseline mt-4 border-b pb-3"},dn={class:"flex items-baseline"},cn={class:"mt-3 flex gap-x-2 items-center"},fn={key:0,class:"codicon codicon-loading animate-spin"},vn={key:1,class:"codicon codicon-check"},hn={key:0},pn={key:1};function yn(e,t,l,o,r,a){return y(),m("div",Xt,[c("div",Qt,[c("div",{class:D(e.$style.importVariant)},"1",2),c("div",null,[t[7]||(t[7]=c("div",{class:"max-w-xl mb-4 font-semibold"},"Useful when a new league is released. While the update is still downloading, you can review files and fix schema directly from the update servers.",-1)),c("div",Zt,[c("div",en,[c("input",{value:"patch(-poe2).poecdn.com/",readonly:"",class:D(e.$style.input)},null,2),c("label",{class:D(e.$style.label)},"Patch CDN",2)]),c("div",tn,[Y(c("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>e.poePatch=n),placeholder:"x.x.x.x.x",class:D(e.$style.input)},null,2),[[Te,e.poePatch,void 0,{trim:!0}]]),c("label",{class:D(e.$style.label)},"Patch #",2)]),c("div",nn,[c("input",{value:"/Bundles2/_.index.bin",readonly:"",class:D(e.$style.input)},null,2),c("label",{class:D(e.$style.label)},"Index",2)]),c("button",{class:"ml-1 py-1 px-3 bg-blue-600 text-white hover:bg-blue-800",onClick:t[1]||(t[1]=(...n)=>e.cdnImport&&e.cdnImport(...n)),disabled:e.isCdnImportRunning,loading:e.isCdnImportRunning},E(e.isCdnImportRunning?"Wait...":"Import"),9,rn)]),e.latestPoEPatch?(y(),m("div",on,[c("p",null,[t[3]||(t[3]=R(" Latest PoE patch is ",-1)),c("code",an,E(e.latestPoEPatch.poe),1),t[4]||(t[4]=R(", and version ",-1)),c("code",ln,E(e.latestPoEPatch.poe2),1),t[5]||(t[5]=R(" for PoE2. ",-1))]),e.index.isLoaded&&e.index.loader.patchVersion!==e.latestPoEPatch.poe&&e.index.loader.patchVersion!==e.latestPoEPatch.poe2?(y(),m("p",sn,[...t[6]||(t[6]=[R(" You can continue to work with cached files.",-1),c("br",null,null,-1),R("But don't delay updating the patch version, otherwise you may experience download errors. ",-1)])])):O("",!0)])):O("",!0)])]),c("div",un,[c("div",{class:D(e.$style.importVariant)},"2",2),c("div",dn,[t[8]||(t[8]=c("span",{class:"pr-2"},"or just",-1)),t[9]||(t[9]=c("label",{class:"bg-gray-100 py-1 px-2 cursor-pointer hover:bg-gray-300",style:{width:"200px"},for:"import-local-file"},"Pick a local dat file",-1)),c("input",{class:"hidden",id:"import-local-file",type:"file",accept:".datc64",onInput:t[2]||(t[2]=(...n)=>e.handleFile&&e.handleFile(...n))},null,32)])]),c("div",cn,[e.isFetchingSchema?(y(),m("i",fn)):(y(),m("i",vn)),c("div",null,[e.isFetchingSchema?(y(),m("span",hn," Downloading schema from ")):(y(),m("span",pn," Downloaded schema from ")),t[10]||(t[10]=c("a",{href:"https://github.com/poe-tool-dev/dat-schema",class:"underline",target:"_blank"},"github.com/poe-tool-dev/dat-schema",-1))])])])}const mn={$style:Kt},gn=ue(jt,[["render",yn],["__cssModules",mn]]),bn=se("poe-dat-viewer@import");function wn(e){bn.value=e}const Re=se([{id:"poe-dat-viewer@import",title:"Import",type:gn,args:void 0,kaScope:ie(!0),kaState:void 0}]);function ct(e){Re.value.find(l=>l.id===e.id)||Re.value.push({id:e.id,title:e.title,type:e.type,args:e.args,kaScope:ie(!0),kaState:void 0}),wn(e.id),oe(Re)}const kn=ae({props:{args:{type:Object,required:!0}},setup(e){return{text:w(()=>{const{name:t,headers:l}=e.args;let o="";for(const r of l){if(r.name==null)break;let a="";if(r.type.boolean?a="bool":r.type.string?a="string":r.type.integer?.size===1?a=r.type.integer.unsigned?"u8":"i8":r.type.integer?.size===2?a=r.type.integer.unsigned?"u16":"i16":r.type.integer?.size===4?a=r.type.integer.unsigned?"u32":"i32":r.type.integer?.size===8?a=r.type.integer.unsigned?"u64":"i64":r.type.decimal?.size===4?a="f32":r.type.decimal?.size===8?a="f64":r.type.key&&(a=r.type.key.foreign?r.type.key.table??"rid":t),r.type.array)o+=`  ${r.name||"_"}: [${a||"_"}]
`;else if(a)o+=`  ${r.name||"_"}: ${a}
`;else break}return`type ${t} {
${o}}
`})}}}),xn={class:"p-4 overflow-auto border-l flex-1 text-base"};function Sn(e,t,l,o,r,a){return y(),m("div",xn,[c("pre",null,E(e.text),1)])}const Cn=ue(kn,[["render",Sn]]),$n=ae({name:"ViewerActions",setup(){const e=V("viewer"),t=V("dat-schemas"),l=B(!1),o=B(null),r=w(()=>Ct(e.columnSelection.value).map(p=>p.map(v=>String(v)).join(" ")));function a(p){o.value&&!o.value.contains(p.target)&&(l.value=!1)}Fe(()=>{document.addEventListener("click",a)}),Ie(()=>{document.removeEventListener("click",a)});function n(){const{editHeader:p,columnSelection:v,headers:g}=e;p.value=$t(v.value,g.value),Mt(v.value),oe(g),oe(v),_e(e,t)}function s(){const p=Ce(e.headers.value,e.datFile);De.saveAs(new File([JSON.stringify(p,null,2)],`${e.name}.json`,{type:"application/json;charset=utf-8"})),l.value=!1}function d(){const p=Ce(e.headers.value,e.datFile);if(p.length===0)return;const v=Object.keys(p[0]),g=[v.join(","),...p.map(x=>v.map($=>{const C=x[$];return C==null?"":typeof C=="string"?`"${C.replace(/"/g,'""')}"`:Array.isArray(C)?`"${JSON.stringify(C).replace(/"/g,'""')}"`:String(C)}).join(","))];De.saveAs(new File([g.join(`
`)],`${e.name}.csv`,{type:"text/csv;charset=utf-8"})),l.value=!1}async function i(){const p=Ce(e.headers.value,e.datFile);await navigator.clipboard.writeText(JSON.stringify(p,null,2)),l.value=!1}function u(){if(e.selectedRow.value===null)return;const v=Ce(e.headers.value,e.datFile)[e.selectedRow.value];v&&navigator.clipboard.writeText(JSON.stringify(v,null,2))}function f(){ct({id:"poe-dat-viewer@show-schema",title:"Schema",type:Cn,args:{name:e.name,headers:JSON.parse(JSON.stringify(e.headers.value))}})}async function h(){await Lt(e,t),await Ot(e,t)}return{rowSorting:e.rowSorting,selectedRow:e.selectedRow,selections:r,showExportMenu:l,exportDropdownRef:o,defineColumn:n,exportDataJson:s,exportDataCsv:d,copyAllToClipboard:i,copySelectedRow:u,showSchema:f,restoreSchema:h}}}),Mn="_bar_1e38q_2",Ln={bar:Mn},On={class:"flex items-center gap-2"},En={key:0,class:"self-center px-1.5 italic text-dark-500"},_n=["textContent"],An={key:3,class:"ml-2 flex items-center gap-2 border-l border-dark-600 pl-2"},Nn={class:"text-dark-400"},Rn={class:"flex gap-x-1"},Tn={ref:"exportDropdownRef",class:"relative"},Dn={key:0,class:"absolute right-0 top-full z-10 mt-1 w-48 rounded-lg border border-dark-600 bg-dark-800 py-1 shadow-lg"};function Fn(e,t,l,o,r,a){return y(),m("div",{class:D(e.$style.bar)},[c("div",On,[e.selections.length===0?(y(),m("div",En,"No bytes selected")):e.selections.length===1?(y(),m("button",{key:1,class:"flex items-center gap-x-1 rounded px-1.5 hover:bg-dark-600 hover:text-dark-100",onClick:t[0]||(t[0]=(...n)=>e.defineColumn&&e.defineColumn(...n))},[...t[9]||(t[9]=[c("i",{class:"codicon codicon-add"},null,-1),R(" Define column ",-1)])])):e.selections.length>1?(y(),m(_,{key:2},[t[10]||(t[10]=c("div",{class:"mr-1 self-center px-1.5 text-dark-400"},"Selections",-1)),(y(!0),m(_,null,W(e.selections,n=>(y(),m("div",{class:"mr-1 flex items-center rounded bg-dark-700 px-1.5 font-mono text-dark-200",textContent:E(n)},null,8,_n))),256))],64)):O("",!0),e.selectedRow!==null?(y(),m("div",An,[c("span",Nn,"Row "+E(e.selectedRow),1),c("button",{class:"flex items-center gap-x-1 rounded bg-dark-700 px-2 py-0.5 text-xs hover:bg-dark-600 hover:text-dark-100",title:"Copy row data (Ctrl+C)",onClick:t[1]||(t[1]=(...n)=>e.copySelectedRow&&e.copySelectedRow(...n))},[...t[11]||(t[11]=[c("i",{class:"codicon codicon-copy"},null,-1),R(" Copy Row ",-1)])])])):O("",!0)]),c("div",Rn,[e.rowSorting?(y(),m("button",{key:0,class:"rounded border border-dark-500 bg-dark-600 px-1.5 hover:bg-dark-500",onClick:t[2]||(t[2]=n=>e.rowSorting=null)}," Clear sorting ")):O("",!0),c("button",{class:"flex items-center gap-x-1 rounded px-1.5 hover:bg-dark-600 hover:text-dark-100",onClick:t[3]||(t[3]=(...n)=>e.restoreSchema&&e.restoreSchema(...n))},[...t[12]||(t[12]=[c("i",{class:"codicon codicon-discard"},null,-1),R(" Restore schema ",-1)])]),c("button",{class:"flex items-center gap-x-1 rounded px-1.5 hover:bg-dark-600 hover:text-dark-100",onClick:t[4]||(t[4]=(...n)=>e.showSchema&&e.showSchema(...n))},[...t[13]||(t[13]=[c("i",{class:"codicon codicon-json"},null,-1),R(" Show schema ",-1)])]),c("div",Tn,[c("button",{class:"flex items-center gap-x-1 rounded px-1.5 hover:bg-dark-600 hover:text-dark-100",onClick:t[5]||(t[5]=n=>e.showExportMenu=!e.showExportMenu)},[...t[14]||(t[14]=[c("i",{class:"codicon codicon-database"},null,-1),R(" Export ",-1),c("i",{class:"codicon codicon-chevron-down text-xs"},null,-1)])]),e.showExportMenu?(y(),m("div",Dn,[c("button",{class:"flex w-full items-center gap-2 px-3 py-2 text-left text-sm text-dark-200 hover:bg-dark-700",onClick:t[6]||(t[6]=(...n)=>e.exportDataJson&&e.exportDataJson(...n))},[...t[15]||(t[15]=[c("i",{class:"codicon codicon-json"},null,-1),R(" Export as JSON ",-1)])]),c("button",{class:"flex w-full items-center gap-2 px-3 py-2 text-left text-sm text-dark-200 hover:bg-dark-700",onClick:t[7]||(t[7]=(...n)=>e.exportDataCsv&&e.exportDataCsv(...n))},[...t[16]||(t[16]=[c("i",{class:"codicon codicon-table"},null,-1),R(" Export as CSV ",-1)])]),t[18]||(t[18]=c("div",{class:"my-1 border-t border-dark-700"},null,-1)),c("button",{class:"flex w-full items-center gap-2 px-3 py-2 text-left text-sm text-dark-200 hover:bg-dark-700",onClick:t[8]||(t[8]=(...n)=>e.copyAllToClipboard&&e.copyAllToClipboard(...n))},[...t[17]||(t[17]=[c("i",{class:"codicon codicon-copy"},null,-1),R(" Copy all to clipboard ",-1)])])])):O("",!0)],512)])],2)}const In={$style:Ln},zn=ue($n,[["render",Fn],["__cssModules",In]]);function Hn(e,t,l){const o=dt(e,l),r=Array.from({length:l.rowCount},(a,n)=>n);return e.type.array?r.sort((a,n)=>{const s=o[a];return(o[n].length-s.length)*t}):e.type.boolean?r.sort((a,n)=>{const s=Number(o[a]),d=Number(o[n]);return(s-d)*t}):e.type.string?r.sort((a,n)=>{const s=o[a],d=o[n];return s.localeCompare(d)*t}):e.type.integer||e.type.decimal?r.sort((a,n)=>{const s=o[a];return(o[n]-s)*t}):e.type.key&&(e.type.key.foreign?r.sort((a,n)=>{const s=o[a];return((o[n]||0)-(s||0))*t}):r.sort((a,n)=>{const s=Number(o[a]);return(Number(o[n])-s)*t})),r}const A={number:"#4ade80",boolean:"#60a5fa",string:"#fbbf24",null:"#f87171",key:"#a78bfa",muted:"#64748b",hex:"#94a3b8"};function Pn(e,t){t.text=String(e),t.color=A.number}function Un(e,t){t.text=e.toLocaleString(void 0,{maximumFractionDigits:6,minimumFractionDigits:1}),t.color=A.number}function Wn(e,t){t.text=`[${e.join(", ")}]`,t.color=A.number}function Vn(e,t){t.text=`[${e.map(l=>l.toLocaleString(void 0,{maximumFractionDigits:6,minimumFractionDigits:1})).join(", ")}]`,t.color=A.number}function Bn(e,t){t.text=String(e),t.color=A.boolean}function qn(e,t){t.text=`[${e.join(", ")}]`,t.color=A.boolean}function jn(e,t){e===""?(t.text="empty",t.color=A.muted):(t.text=String(e),t.color=A.string)}function Gn(e,t){t.text=`[${e.map(l=>JSON.stringify(l)).join(", ")}]`,t.color=A.string}function Je(e,t){e===null?(t.text="<null, self>",t.color=A.null):(t.text=`<${e}, self>`,t.color=A.key)}function Jn(e,t){t.text=`[${e.map(l=>`<${l}, self>`).join(", ")}]`,t.color=A.key}function Ye(e,t){e===null?(t.text="<null>",t.color=A.null):(t.text=`<${e}>`,t.color=A.key)}function Yn(e,t){t.text=`[${e.map(l=>`<${l}>`).join(", ")}]`,t.color=A.key}function Ke(e,t,l,o,r){const a=Be(t,l);if(r?.header.type.array)throw new Error("Can't show array of arrays.");const n=r&&Be(r.header,r.datFile),s={text:"",color:""},d=(()=>{const f=r!=null?r.header.type:t.type;if(t.type.array){if(f.boolean)return qn;if(f.string)return Gn;if(f.integer)return Wn;if(f.decimal)return Vn;if(f.key?.foreign)return Yn;if(f.key)return Jn}else{if(f.boolean)return Bn;if(f.string)return jn;if(f.integer)return Pn;if(f.decimal)return Un;if(f.key?.foreign)return Ye;if(f.key)return Je}throw new Error("never")})();let i=0,u="";for(const f of o){let h=a(f);r?t.type.array?(h=h.map(p=>n(p)),d(h,s)):h===null?(t.type.key.foreign?Ye:Je)(h,s):(h=n(h),d(h,s)):d(h,s),u!==s.color&&(e.fillStyle=s.color,u=s.color),e.fillText(s.text,0,i),i+=H}}function Kn(e,t,l,o,r,a){e.fillStyle=A.hex;let n=0;for(const s of o){const d=l.dataFixed.subarray(s*l.rowLength+t.offset+r,s*l.rowLength+t.offset+a),i=Array.from(d,u=>u.toString(16).padStart(2,"0")).join(" ");e.fillText(i,r*(q*3),n),n+=H}}function Xn(e,t,l,o,r){e.fillStyle=A.hex;const a=r.refArray,n=Math.max(a.keyForeign?l.fieldSize.KEY_FOREIGN:0,a.keySelf?l.fieldSize.KEY:0,a.string?l.fieldSize.STRING:0,a.numeric32?l.fieldSize.LONG:0,l.fieldSize.BYTE),s=Math.ceil(t.textLength/3);let d=0;for(const i of o){const u=l.readerFixed.getUint32(i*l.rowLength+t.offset,!0);if(u===0)e.fillText("[]",0,d);else{const f=l.readerFixed.getUint32(i*l.rowLength+t.offset+l.memsize,!0),h=l.dataVariable.subarray(f,f+Math.min(n*u,s)),p=Array.from(h,v=>v.toString(16).padStart(2,"0")).join(" ");e.fillText(`${u} { ${p} }`,0,d)}d+=H}}const te={background:"#0f172a",text:"#e2e8f0",border:"#334155",selection:"rgba(14, 165, 233, 0.2)",shadow:"rgba(0, 0, 0, 0.3)"},ne='"JetBrains Mono", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',Q=14,q=rr(Q,ne),Qn=or(Q,ne),H=19,Zn=3,re=1,er=7,$e=Math.round(q*3),le=$e*2+er*3;function tr(e){const t=String(e-1).length;return Math.max(t,Zn)}function ft(e){return Math.ceil(tr(e)*q)}function nr(e){return ft(e)+16}function rr(e,t){const o=document.createElement("canvas").getContext("2d");return o.font=`${e}px ${t}`,o.measureText("0").width}function or(e,t){const o=document.createElement("canvas").getContext("2d");o.font=`${e}px ${t}`,o.textBaseline="middle";const r=o.measureText("0");return e/2+(r.alphabeticBaseline!==void 0?-r.alphabeticBaseline:r.actualBoundingBoxDescent)}function ar(e){return 1+(e-Q)/2+Qn}function lr(e){const{ctx:t}=e;if(t.fillStyle=te.background,t.fillRect(0,0,t.canvas.width,t.canvas.height),e.viewer.selectedRow.value!==null){const o=e.rows.indexOf(e.viewer.selectedRow.value);o!==-1&&(t.fillStyle=te.selection,t.fillRect(0,e.top+o*H,t.canvas.width,H))}t.save(),t.translate(-e.left,0),ir(t,e.columns),t.restore(),t.font=`${Q}px ${ne}`,t.fillStyle=te.text;const l=sr(e.viewer,e.left,e.left+e.paintWidth);for(const o of l)t.save(),t.beginPath(),t.translate(o.left-e.left,0),t.rect(0,0,o.width,t.canvas.height),t.clip(),t.translate(q/2,e.top+ar(H)),o.exec(t,e.rows),t.restore();{const o=t.createLinearGradient(0,-16,0,4);o.addColorStop(0,te.shadow),o.addColorStop(1,"transparent"),t.fillStyle=o,t.fillRect(0,0,t.canvas.width,6);const r=t.createLinearGradient(-16,0,4,0);r.addColorStop(0,te.shadow),r.addColorStop(1,"transparent"),t.fillStyle=r,t.fillRect(0,0,6,t.canvas.height)}}function ir(e,t){for(const l of t)l.selected&&(e.fillStyle=te.selection,e.fillRect(l.leftPx+(l.border?re:0),0,l.widthPx,e.canvas.height)),l.border&&(e.fillStyle=te.border,e.fillRect(l.leftPx,0,re,e.canvas.height))}function sr(e,t,l){const o=e.headers.value,r=e.columnStats.value,a=e.datFile,n=[];let s=0;for(const d of o){const i=Ae(d);if(s+i.borderWidth>=t)if(d.type.byteView)if(d.type.byteView.array)n.push({left:s+(i.borderWidth?re:0),width:i.paddingWidth,exec:(u,f)=>{Xn(u,d,a,f,r[d.offset])}});else{const u=Math.max(0,Math.floor((t-s)/(q*3))),f=Math.min(d.length,Math.ceil((l-s)/(q*3)));n.push({left:s+(i.borderWidth?re:0),width:i.paddingWidth,exec:(h,p)=>{Kn(h,d,a,p,u,f)}})}else n.push({left:s+(i.borderWidth?re:0),width:i.paddingWidth,exec:(u,f)=>{if(d.type.key?.table&&d.type.key.viewColumn){const h=e.referencedTables.value.get(d.type.key.table).value;if(h){const p=h.headers.find(v=>v.name===d.type.key.viewColumn);if(p){Ke(u,d,a,f,{header:p,datFile:h.datFile});return}}}Ke(u,d,a,f)}});if(s+=i.borderWidth,s>=l)return n}return n}function Ae(e){const t=e.type.byteView&&!e.type.byteView.array?e.length*3-1:e.textLength;return{paddingWidth:Math.ceil((t+1)*q),borderWidth:Math.ceil((t+1)*q)+(e.offset>0?re:0),hasBorder:e.offset>0}}function ur(e){let t=0;for(const l of e){const o=Ae(l);t+=o.borderWidth}return t}function vt(e,t,l,o){const r=[];let a=0;for(const n of e){const s=Ae(n);if(a+s.borderWidth>=l&&r.push({offset:n.offset,border:s.hasBorder,active:n===t,widthPx:s.borderWidth,leftPx:a,name:n.name}),a+=s.borderWidth,a>=o)return r}return r}const dr=ae({props:{left:{type:Number,required:!0},width:{type:Number,required:!0},columns:{type:Array,required:!0}},setup(e){const t=se(0);let l=-1,o=[];const r=V("viewer"),a=V("dat-schemas");function n(f){l=f,o=[...r.columnSelection.value],qe(r.columnSelection.value,l,l,r.headers.value),oe(r.columnSelection),document.addEventListener("mouseup",h),document.addEventListener("mouseleave",h);function h(){l=-1,document.removeEventListener("mouseup",h),document.removeEventListener("mouseleave",h)}}function s(f,h){if(l===-1||h.buttons!==1)return;const{memsize:p}=r.datFile,v=f-l;v>=p?f=l+p*2-1:v>=4?f=l+8-1:v>=2&&(f=l+4-1),v<=-p?f=l-p*2+1:v<=-4?f=l-8+1:v<=-2&&(f=l-4+1),r.columnSelection.value=[...o],qe(r.columnSelection.value,l,f,r.headers.value)}function d(f){const h=r.headers.value.find(p=>p.offset===f);r.editHeader.value===h&&(!h.type.byteView||h.type.byteView.array)?(t.value===0?t.value=1:t.value===1?t.value=-1:t.value===-1&&(t.value=1),r.rowSorting.value=Hn(h,t.value,r.datFile)):(r.editHeader.value=h,t.value=0)}function i(f,h){h.preventDefault();const p=r.headers.value.find(v=>v.offset===f);p.textLength!=null&&(p.textLength=Math.max(1,p.textLength-Math.sign(h.deltaY)*(h.ctrlKey?10:1)),oe(r.headers),_e(r,a))}return{headers:w(()=>vt(r.headers.value,r.editHeader.value,e.left,e.left+e.width)),selectStart:n,selectContinue:s,editHeader:d,handleHeaderWheel:i,headersRowStyle:w(()=>({transform:`translate(${-e.left}px, 0)`,lineHeight:$e+"px",fontFamily:ne,fontSize:Q+"px"})),colsRowStyle:w(()=>({transform:`translate(${-e.left}px, ${$e}px)`,lineHeight:$e+"px",fontFamily:ne,fontSize:Q+"px"})),statsRowStyle:w(()=>({transform:`translate(${-e.left}px, ${$e*2}px)`,fontFamily:ne,fontSize:Q+"px"}))}}}),cr={class:"datv-header-layer"},fr=["title","onClick","onWheel"],vr={key:1,class:"rounded bg-dark-600 px-1 text-dark-300"},hr=["title","onMousedown","onMouseenter","textContent"],pr={key:0,class:"datv-stat__line bg-yellow-500",style:{top:"0"}},yr={key:1,class:"datv-stat__line bg-green-500",style:{top:"7px"}},mr={key:2,class:"datv-stat__line bg-gray-800",style:{top:"14px"}},gr={key:3,class:"datv-stat__line bg-pink-400",style:{top:"14px"}},br=["textContent"],wr={key:1,class:"mx-auto inline-flex h-full items-center"};function kr(e,t,l,o,r,a){return y(),m("div",cr,[c("div",{style:P(e.headersRowStyle),class:"absolute"},[(y(!0),m(_,null,W(e.headers,n=>(y(),m("button",{key:n.offset,class:D(["datv-header",{"datv-col--border":n.border,"datv-header--active":n.active}]),style:P({width:n.widthPx+"px",transform:`translate(${n.leftPx}px, 0)`}),title:n.name==null?"unidentified":n.name||"unnamed",onClick:s=>e.editHeader(n.offset),onWheel:s=>e.handleHeaderWheel(n.offset,s)},[n.name===null?(y(),m(_,{key:0},[R("Â ")],64)):n.name===""?(y(),m("span",vr,"?")):(y(),m(_,{key:2},[R(E(n.name),1)],64))],46,fr))),128))],4),c("div",{style:P(e.colsRowStyle),class:"absolute"},[(y(!0),m(_,null,W(e.columns,n=>(y(),m("button",{key:n.offset,class:D(["datv-byte",{"datv-col--border":n.border,"datv-byte--selected":n.selected}]),style:P({width:n.widthPx+"px",transform:`translate(${n.leftPx}px, 0)`}),title:String(n.offset),onMousedown:s=>e.selectStart(n.offset),onMouseenter:s=>e.selectContinue(n.offset,s),textContent:E(n.text)},null,46,hr))),128))],4),c("div",{style:P(e.statsRowStyle),class:"datv-stats_row absolute"},[(y(!0),m(_,null,W(e.columns,n=>(y(),m("div",{key:n.offset,class:D(["datv-stat",{"datv-col--border":n.border,"datv-byte--selected":n.selected}]),style:P({width:n.widthPx+"px",transform:`translate(${n.leftPx}px, 0)`})},[n.stat?(y(),m(_,{key:0},[n.stat.string?(y(),m("div",pr)):O("",!0),n.stat.array?(y(),m("div",yr)):O("",!0),n.stat.zero?(y(),m("div",mr)):n.stat.nullable?(y(),m("div",gr)):O("",!0),c("div",{class:"datv-stat__max",textContent:E(n.stat.max)},null,8,br)],64)):n.key?(y(),m("span",wr,[...t[0]||(t[0]=[c("i",{class:"codicon codicon-key"},null,-1)])])):O("",!0)],6))),128))],4)])}const xr=ue(dr,[["render",kr]]);var ee={},ve={},J={},Xe;function K(){if(Xe)return J;Xe=1,Object.defineProperty(J,"__esModule",{value:!0}),J.fillTwoDimensionalArray=J.createTwoDimensionalArray=J.isNullOrUndefined=void 0;function e(o){return o==null}J.isNullOrUndefined=e;function t(o,r){for(var a=Array(o),n=0;n<a.length;n++)a[n]=Array(r);return a}J.createTwoDimensionalArray=t;function l(o,r){r===void 0&&(r=0);for(var a=0,n=o;a<n.length;a++)for(var s=n[a],d=0;d<s.length;d++)s[d]=r}return J.fillTwoDimensionalArray=l,J}var Qe;function Sr(){if(Qe)return ve;Qe=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.JaroWinkler=void 0;var e=K(),t=(function(){function l(o){this.DEFAULT_THRESHOLD=.7,this.THREE=3,this.JW_COEF=.1,this.threshold=o||this.DEFAULT_THRESHOLD}return l.prototype.similarity=function(o,r){if(e.isNullOrUndefined(o))throw new Error("s1 must neither be null nor undefined");if(e.isNullOrUndefined(r))throw new Error("s2 must neither be null nor undefined");if(o===r)return 1;var a=this.matches(o,r),n=a[0];if(n===0)return 0;var s=(n/o.length+n/r.length+(n-a[1])/n)/this.THREE,d=s;return s>this.threshold&&(d=s+Math.min(this.JW_COEF,1/a[this.THREE])*a[2]*(1-s)),d},l.prototype.distance=function(o,r){return 1-this.similarity(o,r)},l.prototype.matches=function(o,r){var a,n;o.length>r.length?(a=o,n=r):(a=r,n=o);var s=Math.max(Math.floor(a.length/2)-1,0),d=Array(n.length);d.fill(-1);for(var i=Array(a.length),u=0,f=0;f<n.length;f++)for(var h=n[f],p=Math.max(f-s,0),v=Math.min(f+s+1,a.length);p<v;p++)if(!i[p]&&h===a[p]){d[f]=p,i[p]=!0,u++;break}for(var g=Array(u),x=Array(u),$=0,C=0;$<n.length;$++)d[$]!==-1&&(g[C]=n[$],C++);for(var $=0,C=0;$<a.length;$++)i[$]&&(x[C]=a[$],C++);for(var M=0,f=0;f<g.length;f++)g[f]!==x[f]&&M++;for(var k=0,f=0;f<n.length&&o[f]===r[f];f++)k++;return[u,Math.floor(M/2),k,a.length]},l})();return ve.JaroWinkler=t,ve}var he={},Ze;function ht(){if(Ze)return he;Ze=1,Object.defineProperty(he,"__esModule",{value:!0}),he.Levenshtein=void 0;var e=K(),t=(function(){function l(){}return l.prototype.distance=function(o,r,a){if(a===void 0&&(a=Number.MAX_VALUE),e.isNullOrUndefined(o))throw new Error("s1 must neither be null nor undefined");if(e.isNullOrUndefined(r))throw new Error("s2 must neither be null nor undefined");if(o===r)return 0;if(o.length===0)return r.length;if(r.length===0)return o.length;for(var n=Array(r.length+1),s=Array(r.length+1),d=[],i=0;i<n.length;i++)n[i]=i;for(var i=0;i<o.length;i++){s[0]=i+1;for(var u=s[0],f=0;f<r.length;f++){var h=1;o[i]===r[f]&&(h=0),s[f+1]=Math.min(s[f]+1,Math.min(n[f+1]+1,n[f]+h)),u=Math.min(u,s[f+1])}if(u>=a)return a;d=n,n=s,s=d}return n[r.length]},l})();return he.Levenshtein=t,he}var pe={},et;function Cr(){if(et)return pe;et=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.CharacterInsDelInterface=void 0;var e=(function(){function t(l,o){this.deletionCost=l,this.insertionCost=o}return t})();return pe.CharacterInsDelInterface=e,pe}var ye={},tt;function $r(){if(tt)return ye;tt=1,Object.defineProperty(ye,"__esModule",{value:!0}),ye.CharacterSubstitutionInterface=void 0;var e=(function(){function t(l){this.cost=l}return t})();return ye.CharacterSubstitutionInterface=e,ye}var me={},nt;function Mr(){if(nt)return me;nt=1,Object.defineProperty(me,"__esModule",{value:!0}),me.NormalizedLevenshtein=void 0;var e=ht(),t=K(),l=(function(){function o(){this.l=new e.Levenshtein}return o.prototype.distance=function(r,a){if(t.isNullOrUndefined(r))throw new Error("s1 must neither be null nor undefined");if(t.isNullOrUndefined(a))throw new Error("s2 must neither be null nor undefined");if(r===a)return 0;var n=Math.max(r.length,a.length);return n===0?0:this.l.distance(r,a)/n},o.prototype.similarity=function(r,a){return 1-this.distance(r,a)},o})();return me.NormalizedLevenshtein=l,me}var ge={},rt;function Lr(){if(rt)return ge;rt=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.WeightedLevenshtein=void 0;var e=K(),t=(function(){function l(o,r){this.charsub=o,this.charchange=r}return l.prototype.distance=function(o,r,a){if(a===void 0&&(a=Number.MAX_VALUE),e.isNullOrUndefined(o))throw new Error("s1 must neither be null nor undefined");if(e.isNullOrUndefined(r))throw new Error("s2 must neither be null nor undefined");if(o===r)return 0;if(o.length===0)return r.length;if(r.length===0)return o.length;var n=Array(r.length+1),s=Array(r.length+1),d=[];n[0]=0;for(var i=1;i<n.length;i++)n[i]=n[i-1]+this.insertionCost(r[i-1]);for(var i=0;i<o.length;i++){var u=o[i],f=this.deletionCost(u);s[0]=n[0]+f;for(var h=s[0],p=0;p<r.length;p++){var v=r[p],g=0;u!==v&&(g=this.charsub.cost(u,v));var x=this.insertionCost(v);s[p+1]=Math.min(s[p]+x,Math.min(n[p+1]+f,n[p]+g)),h=Math.min(h,s[p+1])}if(h>=a)return a;d=n,n=s,s=d}return n[r.length]},l.prototype.insertionCost=function(o){return this.charchange?this.charchange.insertionCost(o):1},l.prototype.deletionCost=function(o){return this.charchange?this.charchange.deletionCost(o):1},l})();return ge.WeightedLevenshtein=t,ge}var be={},ot;function Or(){if(ot)return be;ot=1,Object.defineProperty(be,"__esModule",{value:!0}),be.Damerau=void 0;var e=K(),t=(function(){function l(){}return l.prototype.distance=function(o,r){if(e.isNullOrUndefined(o))throw new Error("s1 must neither be null nor undefined");if(e.isNullOrUndefined(r))throw new Error("s2 must neither be null nor undefined");if(o===r)return 0;for(var a=o.length+r.length,n=new Map,s=0;s<o.length;s++)n.set(o[s],0);for(var s=0;s<r.length;s++)n.set(r[s],0);for(var d=e.createTwoDimensionalArray(o.length+2,r.length+2),i=0;i<=o.length;i++)d[i+1][0]=a,d[i+1][1]=i;for(var u=0;u<=r.length;u++)d[0][u+1]=a,d[1][u+1]=u;for(var i=1;i<=o.length;i++){for(var f=0,u=1;u<=r.length;u++){var h=n.get(r[u-1]),p=f,v=1;o[i-1]===r[u-1]&&(v=0,f=u),d[i+1][u+1]=this.min(d[i][u]+v,d[i+1][u]+1,d[i][u+1]+1,d[h][p]+(i-h-1)+1+(u-p-1))}n.set(o[i-1],i)}return d[o.length+1][r.length+1]},l.prototype.min=function(o,r,a,n){return this.minWithNaN(o,this.minWithNaN(r,this.minWithNaN(a,n)))},l.prototype.minWithNaN=function(o,r){return isNaN(o)&&isNaN(r)?0:isNaN(o)?r:isNaN(r)?o:Math.min(o,r)},l})();return be.Damerau=t,be}var we={},at;function Er(){if(at)return we;at=1,Object.defineProperty(we,"__esModule",{value:!0}),we.OptimalStringAlignment=void 0;var e=K(),t=(function(){function l(){}return l.prototype.distance=function(o,r){if(e.isNullOrUndefined(o))throw new Error("s1 must neither be null nor undefined");if(e.isNullOrUndefined(r))throw new Error("s2 must neither be null nor undefined");if(o===r)return 0;var a=o.length,n=r.length;if(a==0)return n;if(n==0)return a;for(var s=e.createTwoDimensionalArray(a+2,n+2),d=0;d<=a;d++)s[d][0]=d;for(var i=0;i<=n;i++)s[0][i]=i;for(var u,d=1;d<=a;d++)for(var i=1;i<=n;i++)u=1,o.charAt(d-1)==r.charAt(i-1)&&(u=0),s[d][i]=this.min(s[d-1][i-1]+u,s[d][i-1]+1,s[d-1][i]+1),d>1&&i>1&&o.charAt(d-1)===r.charAt(i-2)&&o.charAt(d-2)===r.charAt(i-1)&&(s[d][i]=Math.min(s[d][i],s[d-2][i-2]+u));return s[a][n]},l.prototype.min=function(o,r,a){return Math.min(o,Math.min(r,a))},l})();return we.OptimalStringAlignment=t,we}var ke={},lt;function pt(){if(lt)return ke;lt=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.LongestCommonSubsequence=void 0;var e=K(),t=(function(){function l(){}return l.prototype.distance=function(o,r){if(e.isNullOrUndefined(o))throw new Error("s1 must neither be null nor undefined");if(e.isNullOrUndefined(r))throw new Error("s2 must neither be null nor undefined");return o===r?0:o.length+r.length-2*this.length(o,r)},l.prototype.length=function(o,r){if(e.isNullOrUndefined(o))throw new Error("s1 must neither be null nor undefined");if(e.isNullOrUndefined(r))throw new Error("s2 must neither be null nor undefined");var a=o.length,n=r.length,s=o,d=r,i=e.createTwoDimensionalArray(a+1,n+1);e.fillTwoDimensionalArray(i);for(var u=1;u<=a;u++)for(var f=1;f<=n;f++)s[u-1]===d[f-1]?i[u][f]=i[u-1][f-1]+1:i[u][f]=Math.max(i[u][f-1],i[u-1][f]);return i[a][n]},l})();return ke.LongestCommonSubsequence=t,ke}var xe={},it;function _r(){if(it)return xe;it=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.MetricLCS=void 0;var e=pt(),t=K(),l=(function(){function o(){this.lcs=new e.LongestCommonSubsequence}return o.prototype.distance=function(r,a){if(t.isNullOrUndefined(r))throw new Error("s1 must neither be null nor undefined");if(t.isNullOrUndefined(a))throw new Error("s2 must neither be null nor undefined");if(r===a)return 0;var n=Math.max(r.length,a.length);return n==0?0:1-1*this.lcs.length(r,a)/n},o})();return xe.MetricLCS=l,xe}var Se={},st;function Ar(){if(st)return Se;st=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.NGram=void 0;var e=K(),t=(function(){function l(o){this.DEFAULT_N=2,this.n=e.isNullOrUndefined(o)?this.DEFAULT_N:o}return l.prototype.distance=function(o,r){if(e.isNullOrUndefined(o))throw new Error("s0 must neither be null nor undefined");if(e.isNullOrUndefined(r))throw new Error("s1 must neither be null nor undefined");if(o===r)return 0;var a=`
`,n=o.length,s=r.length;if(n==0||s==0)return 1;var d=0;if(n<this.n||s<this.n){for(var i=0,u=Math.min(n,s);i<u;i++)o.charAt(i)==r.charAt(i)&&d++;return d/Math.max(n,s)}for(var f=Array(n+this.n-1),h,p,v,g=0;g<f.length;g++)g<this.n-1?f[g]=a:f[g]=o.charAt(g-this.n+1);h=Array(n+1),p=Array(n+1);var x,$,C=Array(this.n);for(x=0;x<=n;x++)h[x]=x;for($=1;$<=s;$++){if($<this.n){for(var M=0;M<this.n-$;M++)C[M]=a;for(var M=this.n-$;M<this.n;M++)C[M]=r.charAt(M-(this.n-$))}else C=r.substring($-this.n,$).split("");for(p[0]=$,x=1;x<=n;x++){d=0;for(var k=this.n,u=0;u<this.n;u++)f[x-1+u]!=C[u]?d++:f[x-1+u]==a&&k--;var b=d/k;p[x]=Math.min(Math.min(p[x-1]+1,h[x]+1),h[x-1]+b)}v=h,h=p,p=v}return h[n]/Math.max(s,n)},l})();return Se.NGram=t,Se}var ut;function Nr(){return ut||(ut=1,(function(e){var t=ee&&ee.__createBinding||(Object.create?(function(o,r,a,n){n===void 0&&(n=a),Object.defineProperty(o,n,{enumerable:!0,get:function(){return r[a]}})}):(function(o,r,a,n){n===void 0&&(n=a),o[n]=r[a]})),l=ee&&ee.__exportStar||function(o,r){for(var a in o)a!=="default"&&!r.hasOwnProperty(a)&&t(r,o,a)};Object.defineProperty(e,"__esModule",{value:!0}),l(Sr(),e),l(ht(),e),l(Cr(),e),l($r(),e),l(Mr(),e),l(Lr(),e),l(Or(),e),l(Er(),e),l(pt(),e),l(_r(),e),l(Ar(),e)})(ee)),ee}var Rr=Nr();function Tr(e,t,l){e=e.toLowerCase();const o=[],r=[],a=[],n=new Rr.MetricLCS;for(const i of l)t>=i.totalRows||i.name.toLowerCase()===e||(o.push(i),r.push(i.totalRows-(t+1)),a.push(n.distance(e,i.name.toLowerCase())));const s=new Array(o.length).fill(0);for(const i of[r,a]){const u=Math.min(...i),f=Math.max(...i);for(let h=0;h<i.length;h+=1){const p=(i[h]-u)/(f-u);p>.33&&(s[h]+=p)}}const d=new Array(o.length).fill(0).map((i,u)=>u);return d.sort((i,u)=>s[i]-s[u]),d.map(i=>o[i])}function Dr(e,t,l){const o=[],{fieldSize:r}=l,a=e.length;return a===r.ARRAY&&t.refArray&&o.push({label:"Array",value:"array"}),a===r.STRING&&t.refString&&o.push({label:"String",value:"string"}),a===r.KEY&&t.keySelf&&o.push({label:"Key (self)",value:"key_self"}),a===r.KEY_FOREIGN&&t.keyForeign&&o.push({label:"Key (foreign)",value:"key_foreign"}),(a===4||a===2)&&o.push({label:"Integer",value:"integer"}),a===4&&o.push({label:"Decimal",value:"decimal"}),a===1&&t.maxValue<=1&&o.push({label:"Boolean",value:"boolean"}),o}function Fr(e,t){const l=[];if(!e.type.array||!t.refArray)return l;const o=t.refArray;return o.string&&l.push({label:"String",value:"string"}),o.keySelf&&l.push({label:"Key (self)",value:"key_self"}),o.keyForeign&&l.push({label:"Key (foreign)",value:"key_foreign"}),o.numeric32&&l.push({label:"Integer - 4 bytes",value:"integer_4"}),o.numeric32&&l.push({label:"Decimal - 4 bytes",value:"decimal_4"}),o.boolean&&l.push({label:"Boolean",value:"boolean"}),l}function Ir(e,t){const l=se([]);return t.findByName(e).then(o=>{l.value=o}).catch(()=>{}),l}const zr=ae({setup(){const e=V("viewer"),t=V("dat-schemas"),l=w(()=>e.editHeader.value&&mt(e.editHeader.value));{let v=null;Me(l,g=>{v&&(v(),v=null),g&&(v=Me(g,()=>{oe(e.headers),_e(e,t)},{deep:!0}))})}const o=w(()=>e.columnStats.value[l.value.offset]),r=w({get(){const v=l.value.type;return v.array?"array":v.string?"string":v.key?v.key.foreign?"key_foreign":"key_self":v.integer?"integer":v.decimal?"decimal":v.boolean?"boolean":void 0},set(v){const g=l.value;g.type={},v==="array"?(g.type.array=!0,g.type.byteView={array:!0}):v==="string"?g.type.string={}:v==="key_foreign"?g.type.key={foreign:!0,table:null,viewColumn:null}:v==="key_self"?g.type.key={foreign:!1,table:e.name,viewColumn:null}:v==="integer"?g.type.integer={unsigned:!1,size:g.length}:v==="decimal"?g.type.decimal={size:g.length}:v==="boolean"&&(g.type.boolean={})}}),a=w({get(){const v=l.value.type;return v.string?"string":v.key?v.key.foreign?"key_foreign":"key_self":v.integer?`integer_${v.integer.size}`:v.decimal?`decimal_${v.decimal.size}`:v.boolean?"boolean":void 0},set(v){const g=l.value;g.type={array:!0},v==="string"?g.type.string={}:v==="key_foreign"?g.type.key={foreign:!0,table:null,viewColumn:null}:v==="key_self"?g.type.key={foreign:!1,table:e.name,viewColumn:null}:v==="integer_1"?g.type.integer={unsigned:!1,size:1}:v==="integer_2"?g.type.integer={unsigned:!1,size:2}:v==="integer_4"?g.type.integer={unsigned:!1,size:4}:v==="integer_8"?g.type.integer={unsigned:!1,size:8}:v==="decimal_4"?g.type.decimal={size:4}:v==="decimal_8"?g.type.decimal={size:8}:v==="boolean"&&(g.type.boolean={})}}),n=w(()=>{const v=[],g=l.value.type;return v.push({label:"Bytes",value:"bytes"}),g.array&&v.push({label:"Var. bytes",value:"array-bytes"}),v.push({label:"Data",value:"data",disabled:!r.value||r.value==="array"&&!a.value}),v}),s=w({get(){const v=l.value.type;return v.byteView?v.byteView.array?"array-bytes":"bytes":"data"},set(v){const g=l.value.type;v==="data"?g.byteView=void 0:g.byteView={array:v==="array-bytes"}}}),d=w(()=>{const v=dt(l.value,e.datFile);return Math.max(...l.value.type.array?v.flat():v)}),i=w(()=>{let v;if(!l.value.type.key.foreign)return v=[{value:e.name,label:e.name}],v;if(v=[{value:null,label:"rid (unknown)"}],t.tableStats.length){const g=Tr(e.name,d.value,t.tableStats);v.push(...g.map(x=>({value:x.name,label:x.name})))}else l.value.type.key.table!==null&&v.push({value:l.value.type.key.table,label:l.value.type.key.table});return v}),u=w(()=>l.value.type.key?.table?Ir(l.value.type.key.table,t):null),f=w(()=>{if(!l.value.type.key)return[];const v=[{value:null,label:"row index"}],g=l.value.type.key.foreign?u.value?.value??[]:e.headers.value;return v.push(...g.filter(x=>x.name!==null&&x.name.length&&!x.type.array).map(x=>({label:x.name,value:x.name}))),v});function h(){e.editHeader.value=null}function p(){Et(l.value,e.headers.value),e.editHeader.value=null,oe(e.headers),_e(e,t)}return{isVisible:w(()=>e.editHeader.value!=null),HEADERS_HEIGHT:le,header:l,byteViewMode:s,dataType:r,arrayType:a,close:h,remove:p,viewModeOpts:n,keyTableOpts:i,keyDisplayColumnOpts:f,tablesPreloadNeeded:()=>l.value.type.key!=null?l.value.type.key.foreign&&!t.tableStats.length:!1,dataTypeOpts:w(()=>Dr(l.value,o.value,e.datFile)),arrayTypeOpts:w(()=>Fr(l.value,o.value))}}}),Hr={key:0,style:{width:"300px"},class:"relative overflow-hidden"},Pr={class:"m-2 shadow border border-gray-300 bg-white absolute inset-0 flex flex-col"},Ur={class:"p-2 bg-gray-100 text-gray-600 shadow flex items-center"},Wr={key:0,class:"p-4"},Vr={key:1,class:"p-4 overflow-auto"},Br={class:"mb-4"},qr={class:"mb-4 flex items-baseline"},jr={class:"gap-x-px flex"},Gr=["onClick","disabled","textContent"],Jr={class:"mb-4"},Yr={class:"mb-2 flex justify-between items-baseline"},Kr={class:"inline-flex items-center"},Xr=["value"],Qr={class:"ml-2 cursor-pointer"},Zr={key:0,class:"mt-3"},eo={class:"inline-flex items-center"},to=["value"],no={class:"ml-2 cursor-pointer"},ro={key:0,class:"mb-4"},oo={class:"inline-flex items-center"},ao={key:1,class:"mb-4"},lo=["disabled"],io=["value"],so={key:0,class:"italic mt-2"},uo={key:2,class:"mb-4"},co=["value"],fo={key:3,class:"mb-4"};function vo(e,t,l,o,r,a){return e.isVisible?(y(),m("div",Hr,[c("div",{style:P({height:e.HEADERS_HEIGHT+"px"}),class:"bg-gray-100"},null,4),c("div",Pr,[c("div",Ur,[t[11]||(t[11]=c("span",{class:"px-2"},"Column properties",-1)),c("button",{class:"border border-gray-400 rounded-full px-3",onClick:t[0]||(t[0]=n=>e.$emit("focus-editing-header"))},"Focus"),c("button",{onClick:t[1]||(t[1]=(...n)=>e.close&&e.close(...n)),class:"px-2 py-1 ml-auto",title:"Close"},[...t[10]||(t[10]=[c("i",{class:"codicon codicon-close"},null,-1)])])]),e.header.name===null?(y(),m("div",Wr,[c("div",null,E(e.header.length)+" bytes of unidentified data",1)])):(y(),m("div",Vr,[c("div",Br,[t[12]||(t[12]=c("label",{for:"datv-header-name"},"Name",-1)),Y(c("input",{id:"datv-header-name",placeholder:"Unnamed","onUpdate:modelValue":t[2]||(t[2]=n=>e.header.name=n),class:"border p-1 mt-1 w-full focus:border-blue-500",spellcheck:"false"},null,512),[[Te,e.header.name,void 0,{trim:!0}]])]),c("div",qr,[t[13]||(t[13]=c("div",{class:"mr-2"},"View mode",-1)),c("div",jr,[(y(!0),m(_,null,W(e.viewModeOpts,n=>(y(),m("button",{key:n.value,class:D(["px-2",e.byteViewMode===n.value?"bg-blue-600 text-white":"bg-gray-100 hover:bg-gray-300"]),onClick:s=>e.byteViewMode=n.value,disabled:n.disabled,textContent:E(n.label)},null,10,Gr))),128))])]),c("div",Jr,[c("div",Yr,[t[14]||(t[14]=c("span",null,"Data type",-1)),c("button",{class:"text-red-700 bg-red-100 px-2",onClick:t[3]||(t[3]=(...n)=>e.remove&&e.remove(...n))},"Delete")]),c("div",null,[(y(!0),m(_,null,W(e.dataTypeOpts,n=>(y(),m("div",{key:n.value,class:"mb-0.5"},[c("label",Kr,[Y(c("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=s=>e.dataType=s),value:n.value},null,8,Xr),[[Pe,e.dataType]]),c("span",Qr,E(n.label),1)])]))),128)),e.arrayTypeOpts.length?(y(),m("div",Zr,[t[15]||(t[15]=c("div",{class:"mb-1"},"of ...",-1)),(y(!0),m(_,null,W(e.arrayTypeOpts,n=>(y(),m("div",{key:n.value,class:"mb-0.5"},[c("label",eo,[Y(c("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=s=>e.arrayType=s),value:n.value},null,8,to),[[Pe,e.arrayType]]),c("span",no,E(n.label),1)])]))),128))])):O("",!0)])]),e.header.type.integer?(y(),m("div",ro,[c("label",oo,[Y(c("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=n=>e.header.type.integer.unsigned=n)},null,512),[[gt,e.header.type.integer.unsigned]]),t[16]||(t[16]=c("span",{class:"ml-2 cursor-pointer"},"Unsigned",-1))])])):O("",!0),e.header.type.key?(y(),m("div",ao,[t[17]||(t[17]=c("label",{for:"datv-header-key-table"},"Table",-1)),Y(c("select",{id:"datv-header-key-table",class:"border mt-1 w-full focus:border-blue-500",disabled:e.tablesPreloadNeeded(),"onUpdate:modelValue":t[7]||(t[7]=n=>e.header.type.key.table=n)},[(y(!0),m(_,null,W(e.keyTableOpts,n=>(y(),m("option",{key:n.label,value:n.value},E(n.label),9,io))),128))],8,lo),[[Ue,e.header.type.key.table]]),e.tablesPreloadNeeded()?(y(),m("div",so,"(pre-load all Data Tables to change)")):O("",!0)])):O("",!0),t[22]||(t[22]=c("hr",{class:"my-6"},null,-1)),e.keyDisplayColumnOpts.length?(y(),m("div",uo,[t[18]||(t[18]=c("label",{for:"datv-header-key-column"},"Display Column",-1)),Y(c("select",{id:"datv-header-key-column",class:"border mt-1 w-full focus:border-blue-500","onUpdate:modelValue":t[8]||(t[8]=n=>e.header.type.key.viewColumn=n)},[(y(!0),m(_,null,W(e.keyDisplayColumnOpts,n=>(y(),m("option",{key:n.label,value:n.value},E(n.label),9,co))),128))],512),[[Ue,e.header.type.key.viewColumn]])])):O("",!0),e.dataType?(y(),m("div",fo,[t[19]||(t[19]=c("label",{class:"mr-4"},"Width",-1)),Y(c("input",{"onUpdate:modelValue":t[9]||(t[9]=n=>e.header.textLength=n),class:"border w-16 text-center"},null,512),[[Te,e.header.textLength,void 0,{number:!0}]]),t[20]||(t[20]=R(" chars ",-1)),t[21]||(t[21]=c("div",{class:"italic mt-2"},"(move mouse over the column name in Viewer and use `ScrollWheel`, hold `Ctrl` to increase resize step)",-1))])):O("",!0)]))])])):O("",!0)}const ho=ue(zr,[["render",vo]]),po=Math.ceil(q*3);function yo(e,t,l,o,r){const a=[];let n=0;for(const s of l){const d=Ae(s);if(s.type.byteView&&!s.type.byteView.array){let i=n;for(let u=0;u<s.length;++u){const f=d.hasBorder&&u===0,h=q*3+(f?re:0);if(Math.ceil(i)+h<o){i+=h;continue}const p=s.offset+u;if(a.push({offset:p,selected:e[p],border:f,widthPx:po,leftPx:Math.ceil(i),text:String(p%100).padStart(2,"0"),stat:t[p],key:!1}),i+=h,Math.ceil(i)>=r)return a}}else n+d.borderWidth>=o&&a.push({offset:s.offset,selected:!1,border:d.hasBorder,widthPx:d.paddingWidth,leftPx:n,text:String(s.offset%100).padStart(2,"0"),key:s.type.key!=null});if(n+=d.borderWidth,n>=r)return a}return a}function mo(e,t){const l=e.map(r=>({max:r.maxValue.toString(16).padStart(2,"0"),array:!1,string:!1,nullable:!1,zero:r.maxValue===0})),{fieldSize:o}=t;for(let r=0;r<e.length;++r){const a=e[r];if(a.refString)for(let n=0;n<o.STRING;++n)l[r+n].string=!0;if(a.refArray)for(let n=0;n<o.ARRAY;++n)l[r+n].array=!0;if(a.nullableMemsize)for(let n=0;n<t.memsize;++n)l[r+n].nullable=!0}return l}const go=ae({components:{ResizeObserver:At,CanvasScroll:_t,ViewerActions:zn,ViewerHead:xr,HeaderProps:ho},props:{args:{type:Object,required:!0},kaState:{type:Object,default:void 0},kaScope:{type:Object,required:!0}},emits:["update:kaState"],setup(e,t){const l=V("bundle-index"),o=V("dat-schemas"),r=Ft();let a;e.kaState?a=e.kaState:(a=Nt(e.args.fullPath,e.args.fileContent,l,o,e.kaScope),t.emit("update:kaState",a)),bt("viewer",a);const n=B(null),s=B(null);function d(L){if((L.ctrlKey||L.metaKey)&&L.key==="c"&&a.selectedRow.value!==null){L.preventDefault();const F=Ce(a.headers.value,a.datFile)[a.selectedRow.value];if(F){const X=r.settings.copyFormat;let Le;if(X==="csv"){const ce=Object.keys(F);Le=ce.join(",")+`
`+ce.map(Ne=>{const I=F[Ne];return I==null?"":typeof I=="string"?`"${I.replace(/"/g,'""')}"`:Array.isArray(I)?`"${JSON.stringify(I).replace(/"/g,'""')}"`:String(I)}).join(",")}else if(X==="tsv"){const ce=Object.keys(F);Le=ce.join("	")+`
`+ce.map(Ne=>{const I=F[Ne];return I==null?"":Array.isArray(I)?JSON.stringify(I):String(I)}).join("	")}else Le=JSON.stringify(F,null,2);navigator.clipboard.writeText(Le)}}}Fe(()=>{s.value.scrollTo(a.scrollPos.x,a.scrollPos.y),window.addEventListener("keydown",d)}),Ie(()=>{window.removeEventListener("keydown",d)});const i=w(()=>a.rowSorting.value?a.rowSorting.value:Array.from({length:a.datFile.rowCount},(L,j)=>j)),u=B(0),f=B(0);function h(L){u.value=L.width,f.value=L.height}const{scrollPos:p}=a;function v(L){p.x=L.x,p.y=L.y}const g=w(()=>ur(a.headers.value)),x=w(()=>a.datFile.rowCount*H),$=w(()=>nr(a.datFile.rowCount)),C=w(()=>Math.max(0,u.value-$.value)),M=w(()=>Math.max(0,f.value-le));Me([C,M],()=>{const L=window.devicePixelRatio;n.value.style.width=C.value+"px",n.value.style.height=M.value+"px",n.value.width=C.value*L,n.value.height=M.value*L,n.value.getContext("2d",{alpha:!1}).scale(L,L),N()});const k=w(()=>mo(a.columnStats.value,a.datFile)),b=w(()=>yo(a.columnSelection.value,k.value,a.headers.value,p.x,p.x+Math.min(g.value,C.value))),S=w(()=>{for(const L of a.referencedTables.value.values())L.value});Me([p,b,i,a.selectedRow,S],()=>{N()});function N(){const L=n.value.getContext("2d",{alpha:!1});lr({left:p.x,paintWidth:C.value,top:T.value.top,rows:T.value.ids,columns:b.value,viewer:a,ctx:L})}const T=w(()=>{const L=p.y,j=Math.ceil(M.value/H)+1,F=Math.floor(L/H);return{top:F*H-L,ids:i.value.slice(F,F+j)}});function U(){const L=a.editHeader.value,F=vt(a.headers.value,null,0,0+1/0).find(X=>X.offset===L.offset);s.value.scrollTo(F.leftPx-C.value*.33,void 0)}function Z(L){const{selectedRow:j}=a,F=Math.floor((L.offsetY+p.y)/H),X=i.value[F];j.value=j.value!==X?X:null}const de=w(()=>r.settings.showLineNumbers),He=w(()=>de.value?$.value:0);return{headerBlockStyle:w(()=>({height:le+"px",width:u.value+"px"})),headerOverlayContentStyle:w(()=>({left:He.value+"px",height:le+"px",width:(de.value?C.value:u.value)+"px"})),scrollableStyle:w(()=>({top:le+"px",left:He.value+"px"})),scrollablePaintSize:w(()=>({width:de.value?C.value:u.value,height:M.value})),scrollableFullSize:w(()=>({width:g.value,height:x.value})),rowsOverlayStyle:w(()=>({top:le+"px",width:$.value+"px",height:M.value+"px",fontFamily:ne,fontSize:Q+"px",lineHeight:H+"px"})),showLineNumbers:de,handleScroll:v,handleResize:h,renderItems:T,canvasRef:n,renderColumns:b,scrollLeft:w(()=>p.x),rowsWidth:w(()=>Math.min(g.value,de.value?C.value:u.value)),LINE_HEIGHT:H,canvasScroll:s,rowsNumberWidth:ft(a.datFile.rowCount)+"px",focusEditingHeader:U,handleCanvasClick:Z}}}),bo="_rowsOverlay_1ab2y_2",wo={rowsOverlay:bo},ko={class:"flex flex-1"},xo=["textContent"];function So(e,t,l,o,r,a){const n=fe("viewer-actions"),s=fe("viewer-head"),d=fe("canvas-scroll"),i=fe("resize-observer"),u=fe("header-props");return y(),m(_,null,[z(n),c("div",ko,[z(i,{class:"relative min-h-0 flex-1",onResize:e.handleResize},{default:We(()=>[c("div",{class:"absolute bg-dark-800",style:P(e.headerBlockStyle)},[z(s,{style:P(e.headerOverlayContentStyle),left:e.scrollLeft,width:e.rowsWidth,columns:e.renderColumns},null,8,["style","left","width","columns"])],4),z(d,{ref:"canvasScroll",class:"absolute bg-dark-900",style:P(e.scrollableStyle),"paint-size":e.scrollablePaintSize,"full-size":e.scrollableFullSize,onScroll:e.handleScroll},{default:We(()=>[c("canvas",{ref:"canvasRef",onClick:t[0]||(t[0]=(...f)=>e.handleCanvasClick&&e.handleCanvasClick(...f))},null,512)]),_:1},8,["style","paint-size","full-size","onScroll"]),e.showLineNumbers?(y(),m("div",{key:0,class:D(e.$style.rowsOverlay),style:P(e.rowsOverlayStyle)},[c("div",{class:"absolute",style:P({transform:`translate(0, ${e.renderItems.top}px)`})},[(y(!0),m(_,null,W(e.renderItems.ids,(f,h)=>(y(),m("div",{key:f,style:P({transform:`translate(0, ${h*e.LINE_HEIGHT}px)`,width:e.rowsNumberWidth,position:"absolute"}),textContent:E(f)},null,12,xo))),128))],4)],6)):O("",!0)]),_:1},8,["onResize"]),z(u,{onFocusEditingHeader:e.focusEditingHeader},null,8,["onFocusEditingHeader"])])],64)}const Co={$style:wo},yt=ue(go,[["render",So],["__cssModules",Co]]),$o={key:0,class:"flex items-center border-b border-dark-700 bg-dark-800/50"},Mo={class:"flex flex-1 items-center gap-1 overflow-x-auto px-2 py-1"},Lo=["onClick"],Oo={class:"max-w-32 truncate"},Eo=["onClick"],_o={class:"flex items-center gap-1 border-l border-dark-700 px-2"},Ao=["title"],No={class:"relative flex-1 overflow-hidden"},Ro={key:0,class:"flex h-full flex-col items-center justify-center p-8"},To={class:"mb-6 rounded-2xl bg-dark-800 p-6"},Do={class:"mt-8 flex gap-4"},Fo={class:"btn-primary cursor-pointer"},Io={class:"btn-secondary"},zo={key:2,class:"absolute inset-0 z-50 flex items-center justify-center bg-dark-900/90 backdrop-blur-sm"},Ho={class:"rounded-xl border-2 border-dashed border-primary-500 bg-primary-600/10 p-12 text-center"},jo=ae({__name:"ViewerView",setup(e){const t=xt(),l=Rt(),o=Tt(),r=V("bundle-index"),a=B([]),n=B(null),s=B(!1),d=B(!1),i=w(()=>a.value.find(k=>k.id===n.value));Me(()=>t.query.file,async k=>{k&&typeof k=="string"&&await u(k)},{immediate:!0});async function u(k){const b=a.value.find(S=>S.fullPath===k);if(b){n.value=b.id;return}try{l.setLoading(!0,`Loading ${k}...`);const S=await r.loadFileContent(k),N=k.substring(k.lastIndexOf("/")+1),T=`file-${Date.now()}-${Math.random().toString(36).slice(2,9)}`;a.value.push({id:T,title:N,fullPath:k,fileContent:S,scope:ie()}),n.value=T,o.registerFile(T,k,null)}catch(S){console.error("Failed to load file:",S)}finally{l.setLoading(!1)}}async function f(k){const b=k.target,S=b.files?.[0];if(!S)return;const N=await S.arrayBuffer(),T=new Uint8Array(N),U=`file-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,Z=`local/${S.name}`;a.value.push({id:U,title:S.name,fullPath:Z,fileContent:T,scope:ie()}),n.value=U,o.registerFile(U,Z,null),b.value=""}function h(k){const b=a.value.findIndex(S=>S.id===k);b!==-1&&(a.value[b].scope.stop(),a.value.splice(b,1),o.unregisterFile(k),n.value===k&&(n.value=a.value[Math.min(b,a.value.length-1)]?.id??null))}function p(k,b){b&&o.updateViewer(k,b)}function v(){if(!i.value)return;const k=new Blob([i.value.fileContent.buffer],{type:"application/octet-stream"});De.saveAs(k,i.value.title)}function g(k){k.preventDefault(),d.value=!0}function x(){d.value=!1}async function $(k){k.preventDefault(),d.value=!1;const b=k.dataTransfer?.files[0];if(!b)return;const S=await b.arrayBuffer(),N=new Uint8Array(S),T=`file-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,U=`local/${b.name}`;a.value.push({id:T,title:b.name,fullPath:U,fileContent:N,scope:ie()}),n.value=T,o.registerFile(T,U,null)}function C(){document.getElementById("file-upload")?.click()}async function M(k){const b=k.detail;if(b?.length)for(const S of Array.from(b)){const N=await S.arrayBuffer(),T=new Uint8Array(N),U=`file-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,Z=`local/${S.name}`;a.value.push({id:U,title:S.name,fullPath:Z,fileContent:T,scope:ie()}),n.value=U,o.registerFile(U,Z,null)}}return Fe(()=>{window.addEventListener("open-local-file",C),window.addEventListener("open-local-files",M)}),Ie(()=>{window.removeEventListener("open-local-file",C),window.removeEventListener("open-local-files",M),a.value.forEach(k=>k.scope.stop())}),(k,b)=>(y(),m("div",{class:"flex h-full flex-col",onDragover:g,onDragleave:x,onDrop:$},[c("input",{id:"file-upload",type:"file",accept:".datc64,.dat",class:"hidden",onChange:f},null,32),a.value.length?(y(),m("div",$o,[c("div",Mo,[(y(!0),m(_,null,W(a.value,S=>(y(),m("button",{key:S.id,class:D(["group flex items-center gap-2 rounded-lg px-3 py-1.5 text-sm transition-colors",n.value===S.id?"bg-dark-700 text-dark-100":"text-dark-400 hover:bg-dark-700/50 hover:text-dark-200"]),onClick:N=>n.value=S.id},[z(G(Ht),{class:"h-4 w-4 shrink-0"}),c("span",Oo,E(S.title),1),c("button",{class:"ml-1 rounded p-0.5 opacity-0 transition-opacity hover:bg-dark-600 group-hover:opacity-100",onClick:wt(N=>h(S.id),["stop"])},[z(G(Dt),{class:"h-3 w-3"})],8,Eo)],10,Lo))),128))]),c("div",_o,[c("button",{class:"btn-icon btn-ghost p-1.5",title:"Export",onClick:v},[z(G(It),{class:"h-4 w-4"})]),c("button",{class:"btn-icon btn-ghost p-1.5",title:s.value?"Restore":"Maximize",onClick:b[0]||(b[0]=S=>s.value=!s.value)},[s.value?(y(),Ve(G(Ut),{key:0,class:"h-4 w-4"})):(y(),Ve(G(Pt),{key:1,class:"h-4 w-4"}))],8,Ao)])])):O("",!0),c("div",No,[a.value.length?(y(!0),m(_,{key:1},W(a.value,S=>Y((y(),m("div",{key:S.id,class:"absolute inset-0 flex flex-col bg-dark-900"},[z(yt,{"ka-state":S.state,"onUpdate:kaState":[N=>S.state=N,N=>p(S.id,N)],args:{fileContent:S.fileContent,fullPath:S.fullPath},"ka-scope":S.scope},null,8,["ka-state","onUpdate:kaState","args","ka-scope"])])),[[kt,n.value===S.id]])),128)):(y(),m("div",Ro,[c("div",To,[z(G(Wt),{class:"h-16 w-16 text-dark-600"})]),b[3]||(b[3]=c("h2",{class:"text-xl font-semibold text-dark-200"},"No files open",-1)),b[4]||(b[4]=c("p",{class:"mt-2 text-dark-500"},"Open a .datc64 file to start exploring",-1)),c("div",Do,[c("label",Fo,[z(G(je),{class:"h-4 w-4"}),b[1]||(b[1]=c("span",null,"Open File",-1)),c("input",{type:"file",accept:".datc64,.dat",class:"hidden",onChange:f},null,32)]),c("button",Io,[z(G(zt),{class:"h-4 w-4"}),b[2]||(b[2]=c("span",null,"Browse Index",-1))])]),b[5]||(b[5]=c("p",{class:"mt-6 text-sm text-dark-500"},"or drag and drop a file here",-1))])),d.value?(y(),m("div",zo,[c("div",Ho,[z(G(je),{class:"mx-auto h-12 w-12 text-primary-400"}),b[6]||(b[6]=c("p",{class:"mt-4 text-lg font-medium text-dark-100"},"Drop file to open",-1)),b[7]||(b[7]=c("p",{class:"mt-1 text-sm text-dark-400"},"Supports .datc64 and .dat files",-1))])])):O("",!0)])],32))}});export{jo as default};
